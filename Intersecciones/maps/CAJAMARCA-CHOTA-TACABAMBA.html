<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css"/>
    
            <meta name="viewport" content="width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
            <style>
                #map_108c0da2461da55f1d316e477c36d0aa {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>

            <style>html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            </style>

            <style>#map {
                position:absolute;
                top:0;
                bottom:0;
                right:0;
                left:0;
                }
            </style>

            <script>
                L_NO_TOUCH = false;
                L_DISABLE_3D = false;
            </script>

        
</head>
<body>
    
    
    <style>
      .leaflet-interactive.zs-buffer { pointer-events: none !important; }

      .searchbar-wrap {
        position: fixed; right: 20px; bottom: 140px;
        z-index: 10000; background: rgba(255,255,255,0.95);
        border: 1px solid #e5e7eb;
        padding: 10px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.12);
        font-family: system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;
        display: flex; flex-direction: column; gap: 8px; min-width: 300px; max-width: 92vw;
      }

      .searchbar-header { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
      .searchbar-title { font-weight: 700; font-size: 14px; color: #111827; }
      .toggle-btn { border: 0; border-radius: 8px; padding: 4px 10px; font-weight: 700; cursor: pointer; background: #111827; color: #fff; }
      .tools-body { display: flex; flex-direction: column; gap: 8px; }

      .row-flex { display:flex; gap:8px; align-items:center; }
      .col-flex { display:flex; flex-direction:column; gap:8px; }
      .row-flex input, .col-flex input { border:1px solid #e5e7eb; border-radius:8px; padding:6px 8px; font-size:13px; flex:1; }
      .row-flex button, .col-flex button { border:0; border-radius:8px; padding:6px 10px; font-weight:600; cursor:pointer; }
      .btn-dark  { background:#111827; color:#fff; }
      .btn-gray  { background:#6b7280; color:#fff; }
      .btn-green { background:#065f46; color:#fff; }
      .btn-red   { background:#991b1b; color:#fff; }
      .pill { font-size:12px; padding:4px 8px; border-radius:999px; }
      .dist-on-line { background: rgba(17,24,39,0.85); color: #fff; padding: 2px 6px; border-radius: 6px; font-size: 12px; border: 1px solid rgba(255,255,255,0.2); }

      .searchbar-wrap.collapsed { padding: 8px 10px; }
      .searchbar-wrap.collapsed .tools-body { display: none; }

      @media (max-width: 480px) {
        .searchbar-wrap { right: 12px; bottom: 12px; min-width: 240px; }
      }
    </style>
    
    
    <div style="
        position: fixed; top: 10px; left: 50%; transform: translateX(-50%);
        z-index: 9999; background: rgba(255,255,255,0.9);
        padding: 8px 14px; border-radius: 8px; font-weight: 600;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;">
        CAJAMARCA-CHOTA-TACABAMBA
    </div>
    
    
    <div id="legend-box" style="
        position: fixed; bottom: 20px; right: 20px; z-index: 9999;
        background: rgba(255,255,255,0.9); padding: 10px 12px; border-radius: 8px;
        font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15); line-height: 1.4; min-width: 240px;">
        <div style="font-weight: 600; margin-bottom: 6px;">Leyenda</div>
        <div style="display:flex; align-items:center; gap:8px; margin-bottom:4px;">
            <span style="display:inline-block; width:14px; height:14px; background:#1d4ed8; border-radius:50%;"></span>
            <span>Azul: Intersecci√≥n priorizada</span>
        </div>
        <div style="display:flex; align-items:center; gap:8px;">
            <span style="display:inline-block; width:14px; height:14px; background:#d90429; border-radius:50%;"></span>
            <span>Rojo: Siniestro fatal</span>
        </div>
        <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
            <span style="display:inline-block; width:14px; height:14px; background:#f59e0b; border-radius:50%;"></span>
            <span>Amarillo: Coincidencia de b√∫squeda</span>
        </div>
    </div>
    
    
            <div class="folium-map" id="map_108c0da2461da55f1d316e477c36d0aa" ></div>
        
    
      <div class="searchbar-wrap" id="zs_tools">
        <div class="searchbar-header">
          <div class="searchbar-title">Herramientas</div>
          <button id="btn_toggle_box" class="toggle-btn" title="Mostrar/Ocultar">‚ØÜ Ocultar</button>
        </div>

        <div class="tools-body">
          <div class="col-flex">
            <input id="q_name" type="text" placeholder="Buscar por nombre">
            <input id="q_code" type="text" placeholder="Buscar por c√≥digo">
          </div>
          <div class="row-flex">
            <button id="btn_search" class="btn-dark">Buscar</button>
            <button id="btn_clear" class="btn-gray">Limpiar</button>
          </div>

          <hr style="border:none;border-top:1px solid #e5e7eb; margin:4px 0;">

          <div class="col-flex" title="Coordenadas en grados decimales">
            <input id="q_x" type="text" placeholder="Longitud Ejem: -77.15435">
            <div class="row-flex">
              <input id="q_y" type="text" placeholder="Latitud Ejem: -15.54648">
              <button id="btn_xy_go" class="btn-green" title="Centrar en coordenadas">üîç</button>
              <button id="btn_xy_clear" class="btn-red"   title="Quitar pin de coordenadas">‚úï</button>
            </div>
          </div>

          <div class="row-flex">
            <button id="btn_measure_toggle" class="btn-dark pill" title="Medir distancia">Medir distancia</button>
            <span id="measure_state" style="font-size:12px; color:#991b1b">Desactivado</span>
          </div>

          <div class="row-flex">
            <button id="btn_open_gmaps" class="btn-dark" title="Abrir esta vista en Google Maps">Abrir en Google Maps</button>
          </div>
        </div>
      </div>
    
</body>
<script>
    
    
            var map_108c0da2461da55f1d316e477c36d0aa = L.map(
                "map_108c0da2461da55f1d316e477c36d0aa",
                {
                    center: [-6.4134872666666665, -78.62600903333335],
                    crs: L.CRS.EPSG3857,
                    ...{
  "zoom": 14,
  "zoomControl": true,
  "preferCanvas": false,
}

                }
            );
            L.control.scale().addTo(map_108c0da2461da55f1d316e477c36d0aa);

            

        
    
            var tile_layer_5e19b3b297d98a719d413439ffa16e24 = L.tileLayer(
                "https://tile.openstreetmap.org/{z}/{x}/{y}.png",
                {
  "minZoom": 0,
  "maxZoom": 19,
  "maxNativeZoom": 19,
  "noWrap": false,
  "attribution": "\u0026copy; \u003ca href=\"https://www.openstreetmap.org/copyright\"\u003eOpenStreetMap\u003c/a\u003e contributors",
  "subdomains": "abc",
  "detectRetina": false,
  "tms": false,
  "opacity": 1,
}

            );
        
    
            tile_layer_5e19b3b297d98a719d413439ffa16e24.addTo(map_108c0da2461da55f1d316e477c36d0aa);
        
    
            var feature_group_5e24ce67df1756499e19bdcbd436fd98 = L.featureGroup(
                {
}
            );
        
    
        function geo_json_1091ac6d23d1030630f6c8bab5b6f53f_styler(feature) {
            switch(feature.properties.IDDPTO) {
                default:
                    return {"color": "#222222", "fill": true, "fillColor": "#9ca3af", "fillOpacity": 0.3, "opacity": 1.0, "weight": 2.5};
            }
        }

        function geo_json_1091ac6d23d1030630f6c8bab5b6f53f_onEachFeature(feature, layer) {

            layer.on({
            });
        };
        var geo_json_1091ac6d23d1030630f6c8bab5b6f53f = L.geoJson(null, {
                onEachFeature: geo_json_1091ac6d23d1030630f6c8bab5b6f53f_onEachFeature,
            
                style: geo_json_1091ac6d23d1030630f6c8bab5b6f53f_styler,
            ...{
}
        });

        function geo_json_1091ac6d23d1030630f6c8bab5b6f53f_add (data) {
            geo_json_1091ac6d23d1030630f6c8bab5b6f53f
                .addData(data);
        }
            geo_json_1091ac6d23d1030630f6c8bab5b6f53f_add({"features": [{"geometry": {"coordinates": [[[[-78.65305148699997, -6.369834348999973], [-78.65218648799998, -6.369859974999883], [-78.64870911299994, -6.36880159999987], [-78.6479704869999, -6.368481349999968], [-78.64716736299988, -6.368374223999979], [-78.6467122379999, -6.368708849999962], [-78.6458288629999, -6.370488974999887], [-78.64540061299994, -6.372362849999945], [-78.64451723699995, -6.374303599999962], [-78.64389023799998, -6.374661848999892], [-78.64339298699997, -6.374946099999875], [-78.63956498799996, -6.375133473999938], [-78.63803911299993, -6.374865723999903], [-78.63678223699992, -6.374758849999864], [-78.6353756129999, -6.374972849999892], [-78.63062411299995, -6.375695599999915], [-78.62804461299999, -6.375694098999872], [-78.62411673799994, -6.375209099999893], [-78.62241948799993, -6.374999599999967], [-78.61990923799982, -6.374689723999893], [-78.61916711199996, -6.374598098999968], [-78.61740036199996, -6.374785473999907], [-78.61659723699995, -6.375146849999965], [-78.61501361299992, -6.376330099999905], [-78.61388061299988, -6.376414348999958], [-78.61280948799998, -6.376297848999911], [-78.61218136299988, -6.376229599999874], [-78.6115781129999, -6.376164099999869], [-78.61029886299991, -6.376423724999938], [-78.60759748799995, -6.376987474999964], [-78.60611061199995, -6.376868348999949], [-78.60478111299989, -6.376564474999952], [-78.60294586299995, -6.375712098999941], [-78.60272636299999, -6.375610349999874], [-78.60196686199993, -6.375177723999968], [-78.60097748799996, -6.374919348999981], [-78.59820648799985, -6.374817348999898], [-78.59725348699993, -6.374821974999918], [-78.59683686299996, -6.374792724999907], [-78.59313773799994, -6.373952223999936], [-78.59223436299999, -6.373626974999979], [-78.59174023799994, -6.373173849999887], [-78.59144336299988, -6.372746099999972], [-78.59095111299996, -6.37157034899991], [-78.5904453629999, -6.369705099999976], [-78.59010548799995, -6.368998099999885], [-78.58979098799995, -6.368537099999969], [-78.5895156119999, -6.367550723999955], [-78.58919336299988, -6.366970724999931], [-78.58895511299988, -6.365802723999934], [-78.58856248799992, -6.364861349999842], [-78.58841986199991, -6.364308599999958], [-78.58803323699993, -6.363792974999967], [-78.5870272379999, -6.362875099999883], [-78.58597661299984, -6.361306599999978], [-78.58574423699997, -6.360853474999942], [-78.58569148799995, -6.360644473999969], [-78.58571861299998, -6.36051759999998], [-78.58540036299996, -6.360814473999937], [-78.58501948799994, -6.361066349999874], [-78.58459561299998, -6.361253849999969], [-78.58373636199991, -6.361466848999896], [-78.58317386299996, -6.361744098999907], [-78.58249411299983, -6.362330098999905], [-78.58164261299999, -6.362949223999976], [-78.58018361299997, -6.363882849999868], [-78.57975586299995, -6.364242223999952], [-78.57910348799993, -6.364970723999932], [-78.57858398799993, -6.365943349999839], [-78.5781014879999, -6.366484349999837], [-78.57780073699996, -6.367269474999944], [-78.57765423799992, -6.367511724999929], [-78.57705473799996, -6.368177723999963], [-78.57611323699996, -6.36884372499992], [-78.57573048799992, -6.369292974999951], [-78.57518361299998, -6.370357348999903], [-78.57510161199986, -6.370455098999912], [-78.57477536199997, -6.37081634999987], [-78.57271873699995, -6.371818348999909], [-78.57165036199996, -6.372626974999946], [-78.57077148799993, -6.372912099999894], [-78.57020111199995, -6.373343723999938], [-78.56971286199996, -6.373466848999897], [-78.56874611299997, -6.373427724999942], [-78.56823048799993, -6.373515598999916], [-78.56768748699994, -6.373828098999923], [-78.56691598799989, -6.37445697499993], [-78.56630073699995, -6.37473434899988], [-78.56565623699993, -6.37533784999988], [-78.56499411299995, -6.375749973999973], [-78.56443161199996, -6.376226599999882], [-78.56301173799989, -6.376806599999895], [-78.56200586299997, -6.377562474999934], [-78.5608007379999, -6.378025349999973], [-78.56000386199997, -6.378429723999943], [-78.55958598799992, -6.378841849999901], [-78.55878711299994, -6.379914099999894], [-78.55822073799987, -6.381005849999895], [-78.5576757369999, -6.381644473999927], [-78.55687886299995, -6.382019474999936], [-78.5563534879999, -6.382388724999942], [-78.5557382369999, -6.382548849999921], [-78.555158238, -6.382888723999827], [-78.55513086299999, -6.382923848999951], [-78.55362123799989, -6.383314474999963], [-78.5521464869999, -6.383804724999948], [-78.55116011299998, -6.383882848999917], [-78.55001561199998, -6.383650349999868], [-78.54916598699992, -6.383374974999981], [-78.54699998699988, -6.383048849999909], [-78.54517573799984, -6.383085974999972], [-78.54400786199994, -6.383269473999974], [-78.54328711199997, -6.383211098999936], [-78.54247461299997, -6.382900349999886], [-78.54093361299994, -6.38211522499995], [-78.5395247379999, -6.381780849999927], [-78.53783423699991, -6.381858598999941], [-78.53670998799998, -6.382308474999945], [-78.53476698699995, -6.383085598999969], [-78.5297072379999, -6.383529099999976], [-78.52453548799991, -6.383625473999928], [-78.52055223699995, -6.383336348999933], [-78.51843211199997, -6.382404848999954], [-78.51740423799998, -6.380702224999936], [-78.5169544879999, -6.378967598999907], [-78.51634423699994, -6.377650474999939], [-78.51474611199995, -6.375898473999939], [-78.51202736199991, -6.374095724999961], [-78.51112498699996, -6.373874973999932], [-78.51016011199994, -6.373527348999914], [-78.50918548799996, -6.373341849999861], [-78.50882423799999, -6.373033224999972], [-78.50823236199989, -6.372306598999899], [-78.50709373799998, -6.370330224999975], [-78.506285113, -6.369496099999878], [-78.50510548699998, -6.368630849999874], [-78.50493548799994, -6.368341848999933], [-78.50438861299989, -6.367724598999871], [-78.5041816129999, -6.367361349999896], [-78.50391586299997, -6.366275349999967], [-78.50392386199991, -6.366132848999882], [-78.50405473799998, -6.363636723999946], [-78.50392773799996, -6.361837849999972], [-78.5039238629999, -6.361830098999917], [-78.50360548799995, -6.361230474999957], [-78.50298636199994, -6.360369099999957], [-78.50216986299989, -6.359425724999937], [-78.5014218629999, -6.358937474999948], [-78.50076161299984, -6.357705098999872], [-78.50036523699998, -6.356822223999927], [-78.500189488, -6.355369098999972], [-78.49957223799993, -6.353251974999921], [-78.49921873699998, -6.352415974999928], [-78.49868948799997, -6.351753849999966], [-78.4978086129999, -6.350873099999944], [-78.4972363629999, -6.35038872399997], [-78.49674998799998, -6.35034372399997], [-78.4961328629999, -6.34981447399997], [-78.49507611299998, -6.349374973999943], [-78.4941953629999, -6.349109349999935], [-78.49291598799994, -6.34840434899985], [-78.49159373799995, -6.347874973999922], [-78.49013861299983, -6.347169973999939], [-78.48855273699996, -6.346025348999831], [-78.4877148619999, -6.345716974999959], [-78.48692186299996, -6.345099599999969], [-78.48630473699995, -6.344878848999826], [-78.48555648799993, -6.34426172499991], [-78.48507036299998, -6.344040973999938], [-78.48414448799991, -6.343423848999976], [-78.48288086299988, -6.342134723999948], [-78.48242973799995, -6.342712848999952], [-78.48195511299997, -6.343189473999928], [-78.48073823699997, -6.34422847399992], [-78.48022073699997, -6.344910099999936], [-78.47860548799991, -6.346814474999917], [-78.47626361299996, -6.349974598999893], [-78.47592386199989, -6.350292974999945], [-78.47543548699991, -6.3506484749999], [-78.47396486199989, -6.35152734899998], [-78.47333011299997, -6.351859349999813], [-78.47281836199988, -6.352234349999947], [-78.47242573799991, -6.352722599999936], [-78.47192573699994, -6.353349598999898], [-78.47142973799993, -6.35408984999998], [-78.47075011299995, -6.354841849999957], [-78.47028123799993, -6.355488224999931], [-78.46983598799994, -6.356011723999927], [-78.46968361299997, -6.356138723999948], [-78.46862698699994, -6.357037098999854], [-78.46730073799989, -6.357685598999865], [-78.46648436199996, -6.358185599999956], [-78.46569536299995, -6.358878848999893], [-78.46425386299995, -6.360148598999899], [-78.4637304869999, -6.360775349999869], [-78.46291011299996, -6.361761724999951], [-78.46255473699995, -6.362123099999963], [-78.46134761299999, -6.362927848999902], [-78.45930661199998, -6.364921849999973], [-78.45894336299995, -6.365380849999838], [-78.45882423799992, -6.36562309999988], [-78.45864848799988, -6.366335973999981], [-78.45855861299998, -6.366695474999972], [-78.45844336199997, -6.366992223999944], [-78.45742386199998, -6.36775197399993], [-78.45633011199999, -6.368937473999949], [-78.45514061299997, -6.371058598999923], [-78.45501561199995, -6.371449224999935], [-78.45381448699993, -6.373554723999973], [-78.45310161199995, -6.374478474999933], [-78.45262111199997, -6.37544722399997], [-78.45211523799998, -6.37588672499993], [-78.4505624869999, -6.376794974999939], [-78.45033786199997, -6.377189474999966], [-78.45011136299996, -6.377453099999855], [-78.44870111299997, -6.378779349999888], [-78.4478359879999, -6.380488224999965], [-78.44702536199998, -6.382871099999875], [-78.44657811299993, -6.383542974999955], [-78.44614448799996, -6.384011724999937], [-78.44586723799989, -6.384490223999819], [-78.44586136199996, -6.384964848999914], [-78.44599223799997, -6.385523474999957], [-78.44650586299997, -6.387095724999938], [-78.44669336199996, -6.387437473999967], [-78.44723823799984, -6.388048724999976], [-78.44820311299998, -6.389437474999966], [-78.44848048799997, -6.390042974999972], [-78.44901761299997, -6.392431724999938], [-78.4492207379999, -6.392993973999978], [-78.44928911199997, -6.393308599999898], [-78.44930473799991, -6.394759724999972], [-78.44935736199994, -6.395023598999956], [-78.44964061199994, -6.395787098999961], [-78.44976761199996, -6.396464849999916], [-78.4497597379999, -6.397068348999937], [-78.44961911199994, -6.398072224999964], [-78.44954886299996, -6.400126973999875], [-78.44945511299994, -6.400511724999944], [-78.44932611199994, -6.401040974999944], [-78.44932611299993, -6.401337849999891], [-78.44933011199998, -6.402064474999975], [-78.4492187379999, -6.402472599999896], [-78.44887886299995, -6.403050724999957], [-78.44786323799997, -6.404197224999962], [-78.44729098699992, -6.404962849999947], [-78.44674798799997, -6.405943349999916], [-78.44619148699991, -6.407263598999975], [-78.44605273799988, -6.409046849999925], [-78.44604886299993, -6.409994099999949], [-78.44610161199995, -6.410486348999939], [-78.44607423699989, -6.411374974999831], [-78.44583011299994, -6.412814473999902], [-78.44552348799988, -6.41387697499988], [-78.44495511199995, -6.414880723999886], [-78.44394711299992, -6.416496098999971], [-78.44346873699999, -6.417376973999922], [-78.4430859869999, -6.418238224999868], [-78.44258786199998, -6.419193348999954], [-78.44235348699988, -6.419796974999883], [-78.44196286199997, -6.42027534999994], [-78.44074223799998, -6.42150584999996], [-78.44025386299995, -6.422197224999877], [-78.43999798699986, -6.422876974999895], [-78.43985736299993, -6.423439474999896], [-78.43986323799999, -6.424271474999898], [-78.44018948699988, -6.426191348999964], [-78.44051173799988, -6.427142599999968], [-78.44063086299997, -6.427773473999935], [-78.44050386299995, -6.428847599999926], [-78.44049223799988, -6.428947224999888], [-78.44045898799999, -6.429581974999905], [-78.4405097369999, -6.430097598999964], [-78.44058986199997, -6.430453098999976], [-78.44059173799997, -6.430767598999978], [-78.44045311199994, -6.43145697499989], [-78.44026361299996, -6.433212973999957], [-78.43991798799988, -6.435023474999923], [-78.43965236199995, -6.435972598999967], [-78.43943161299995, -6.437839848999829], [-78.43925586299991, -6.43833009899987], [-78.43899223799997, -6.438763724999887], [-78.43887111299995, -6.439046849999954], [-78.43874798799999, -6.439705099999969], [-78.43873636299992, -6.440021474999924], [-78.43886923799988, -6.441146474999925], [-78.43887111199996, -6.442181599999969], [-78.43891598799996, -6.442785098999877], [-78.43908198799983, -6.443796849999956], [-78.43903711199994, -6.444628849999958], [-78.43919923699991, -6.445525349999969], [-78.43938473799983, -6.446009724999897], [-78.43975786299995, -6.44670122399998], [-78.44019136199995, -6.447367224999937], [-78.44094723799998, -6.44876759999994], [-78.44129686299993, -6.449242224999921], [-78.44188086199995, -6.449874974999943], [-78.44307811299996, -6.45094534999987], [-78.44368748699992, -6.451611349999951], [-78.44536523799997, -6.453259724999896], [-78.44601948699989, -6.454003849999935], [-78.44607611199996, -6.454089849999946], [-78.44671486199996, -6.454074224999943], [-78.44705861199998, -6.453994099999818], [-78.44882611299994, -6.453330098999857], [-78.44963286299998, -6.453076223999972], [-78.45040623699992, -6.452933599999824], [-78.45086136199996, -6.452726599999949], [-78.45175973799985, -6.451966848999859], [-78.45251561299995, -6.451175723999938], [-78.45373048699992, -6.450326224999912], [-78.45472261299994, -6.448939473999928], [-78.45514273699996, -6.448540974999901], [-78.45558011199995, -6.448204974999896], [-78.45664261199994, -6.44775384999997], [-78.45693161199995, -6.44775384899998], [-78.45731836299996, -6.447845724999922], [-78.45825386199994, -6.448259599999972], [-78.45871673799991, -6.448421849999932], [-78.46026173799987, -6.448621099999968], [-78.46104298799992, -6.44891597499992], [-78.46172261199996, -6.449117223999963], [-78.4623652379999, -6.449203098999874], [-78.46351948799992, -6.44911134899985], [-78.4642597369999, -6.448986349999871], [-78.46595898699991, -6.448435599999868], [-78.46670898799988, -6.448136724999927], [-78.46716598799992, -6.448039098999971], [-78.46742973799991, -6.448029349999956], [-78.46941011299998, -6.448255849999953], [-78.47075586299997, -6.448312349999981], [-78.47084173799988, -6.44831634999997], [-78.47225786199988, -6.448027348999972], [-78.47229486299995, -6.448023473999967], [-78.47339636299995, -6.447939474999941], [-78.4743104879999, -6.44771097499995], [-78.47471286299998, -6.447720723999964], [-78.47590623699995, -6.447915974999887], [-78.47827736299996, -6.447886723999943], [-78.47892973799992, -6.447706974999903], [-78.47928711299994, -6.447521474999917], [-78.47974223799991, -6.447181599999965], [-78.48058198799993, -6.446445348999873], [-78.48105073799991, -6.446148473999926], [-78.48222661299997, -6.445525348999979], [-78.48257423699994, -6.445404349999819], [-78.4829667379999, -6.445345599999939], [-78.48383986299996, -6.445478473999913], [-78.4843847379999, -6.445414099999937], [-78.48574236299999, -6.444642599999952], [-78.48703123799993, -6.444056599999954], [-78.48775973799991, -6.443580098999973], [-78.4890781119999, -6.442874974999881], [-78.48942773699997, -6.442634724999891], [-78.48992573699996, -6.442113099999972], [-78.49002348799996, -6.442011724999929], [-78.49031448799997, -6.441896474999908], [-78.49124798799994, -6.441822224999896], [-78.49147261199988, -6.441861349999954], [-78.49192386199991, -6.442121098999962], [-78.49285936199988, -6.442874974999881], [-78.49333986299985, -6.443035098999871], [-78.49405861199989, -6.443013724999901], [-78.49573048799994, -6.442626974999939], [-78.49664848699996, -6.442478474999916], [-78.49698436299997, -6.442474599999969], [-78.49732611199988, -6.442623099999935], [-78.49756836199992, -6.442833849999943], [-78.4982323619999, -6.44389259999997], [-78.49838861199987, -6.444011724999939], [-78.49876561199989, -6.444189474999916], [-78.49922848799997, -6.444183599999974], [-78.50001561199991, -6.443800724999903], [-78.50021486299988, -6.443783224999891], [-78.50033986199992, -6.443802723999966], [-78.50073823799994, -6.443984348999834], [-78.50090823799997, -6.444093723999913], [-78.5010976129999, -6.444285099999945], [-78.50120511199992, -6.444456974999923], [-78.50126761299998, -6.444611349999946], [-78.5013398619999, -6.444738224999924], [-78.50144723799997, -6.444937474999904], [-78.50172261199992, -6.445634724999934], [-78.50220898799995, -6.446132849999969], [-78.50292973799998, -6.44635347499991], [-78.50348836199993, -6.446701224999913], [-78.50442773799995, -6.446884723999915], [-78.50574023799999, -6.448021473999972], [-78.50667973799995, -6.448378849999926], [-78.50687698799999, -6.448453098999892], [-78.50757423799996, -6.448427723999941], [-78.50940236299988, -6.447650348999957], [-78.51103911299992, -6.447451224999952], [-78.51152736299991, -6.447308599999815], [-78.51237111299992, -6.44645509999998], [-78.51304298799994, -6.446078099999966], [-78.51357611299989, -6.44591797399994], [-78.5139198629999, -6.445658223999942], [-78.51449223799995, -6.445027349999975], [-78.51534373699997, -6.444498099999976], [-78.5165176129999, -6.443165973999953], [-78.51698048799994, -6.442382849999944], [-78.51713473699988, -6.442238223999937], [-78.51748048699989, -6.44208784999995], [-78.51808598699989, -6.442044974999931], [-78.51897073699996, -6.441859348999969], [-78.51955073799996, -6.441599598999971], [-78.52052923799994, -6.441279348999842], [-78.52098236299992, -6.440884724999876], [-78.52163673799998, -6.439874974999896], [-78.52185548799997, -6.439632848999963], [-78.52275198799998, -6.439183599999978], [-78.52384573799998, -6.439162099999976], [-78.52451561199996, -6.43900384899996], [-78.52551173699999, -6.438439474999882], [-78.52672661299994, -6.437603474999889], [-78.5267538629999, -6.43757622399994], [-78.52731448799994, -6.437390599999958], [-78.5278652369999, -6.437292973999945], [-78.5284707369999, -6.437269473999947], [-78.53026761299992, -6.437638724999886], [-78.53276173799998, -6.437732474999905], [-78.53363673799998, -6.437917974999891], [-78.53448436299993, -6.438292974999911], [-78.53549223799996, -6.438966849999929], [-78.53560361199999, -6.43905634999993], [-78.53657398799999, -6.440245223999966], [-78.53956073799992, -6.442235723999943], [-78.54189261299996, -6.444109349999962], [-78.54454548699994, -6.443724723999935], [-78.54638673699992, -6.442822848999981], [-78.55050086299997, -6.440530474999946], [-78.55229136299988, -6.440348723999932], [-78.55374286299991, -6.44042009899988], [-78.55569398799997, -6.440277349999974], [-78.55643161299997, -6.439753848999942], [-78.55670136299995, -6.439360099999931], [-78.55819236299999, -6.437184098999921], [-78.56216611299999, -6.434043223999936], [-78.56440286299988, -6.433162724999931], [-78.56749148799997, -6.432572598999911], [-78.56874448699995, -6.432610724999961], [-78.56987386299994, -6.432645099999888], [-78.57125561199996, -6.432686974999967], [-78.57246561299996, -6.431933973999946], [-78.57446798799998, -6.430688099999884], [-78.57454936199997, -6.430631098999868], [-78.57777998799997, -6.428221099999973], [-78.57874386299994, -6.427272224999967], [-78.58027386299995, -6.426428849999979], [-78.58217736299997, -6.424834724999869], [-78.58448548799998, -6.423335599999916], [-78.58710286199994, -6.421336849999932], [-78.58822123799985, -6.420313724999914], [-78.58931573699988, -6.419623599999909], [-78.59043548799991, -6.418259724999871], [-78.59082423799993, -6.4180722239999], [-78.59308786299988, -6.417142598999931], [-78.5945566129999, -6.415874974999838], [-78.59558986299999, -6.415400349999913], [-78.59617573799994, -6.415529349999929], [-78.59662698799997, -6.415775348999944], [-78.59694136299998, -6.416048848999935], [-78.59802348699998, -6.41677747499989], [-78.59855473799996, -6.417005849999953], [-78.59911523799997, -6.41709759999992], [-78.60100398699996, -6.417070474999889], [-78.60168161299998, -6.416947223999898], [-78.60311136299987, -6.416222599999912], [-78.60351173799995, -6.415826223999886], [-78.6037753629999, -6.415412099999969], [-78.60376761299989, -6.415058598999963], [-78.6038066129999, -6.414580099999966], [-78.60412498799997, -6.414039098999979], [-78.60570511299989, -6.412285099999906], [-78.60616798699982, -6.411915974999829], [-78.6065038619999, -6.411464849999959], [-78.6071621129999, -6.410058598999967], [-78.60778323699998, -6.408371098999964], [-78.60897261299988, -6.407265599999903], [-78.60960948699989, -6.406499974999974], [-78.6096073629999, -6.406607474999873], [-78.60976961299991, -6.406980474999955], [-78.61002923799998, -6.407234348999964], [-78.61109373699998, -6.407826223999905], [-78.61278898799998, -6.408331974999953], [-78.61378123799994, -6.408851599999934], [-78.61466598699997, -6.409035098999937], [-78.6152773629999, -6.409400348999952], [-78.61589848799997, -6.409917974999871], [-78.61655473699989, -6.410753849999935], [-78.61683398799994, -6.410980473999871], [-78.61718548799996, -6.411154349999947], [-78.61800786199996, -6.411302723999881], [-78.61896298799996, -6.411830098999928], [-78.61977348799996, -6.412412098999937], [-78.62170311199992, -6.413036973999965], [-78.62235161299992, -6.413499973999876], [-78.62339448799997, -6.414626974999976], [-78.62438473799995, -6.415490224999871], [-78.62577723699997, -6.416986348999956], [-78.62649023799997, -6.417568349999954], [-78.6272558629999, -6.417998098999931], [-78.62783011299996, -6.418578098999944], [-78.62843361299991, -6.419005848999973], [-78.62856048699985, -6.419214848999957], [-78.62883598799988, -6.420056599999953], [-78.62954686299992, -6.420863224999891], [-78.62957236299997, -6.421099599999934], [-78.62947848799996, -6.421785099999965], [-78.62953123799997, -6.422111348999977], [-78.62979298799996, -6.422384723999926], [-78.63004486299991, -6.422456974999875], [-78.63163473799995, -6.422619098999974], [-78.63180661299992, -6.422636724999904], [-78.63223823799996, -6.422837848999961], [-78.63243748799988, -6.423009724999872], [-78.63281248799996, -6.423915974999886], [-78.63325198799998, -6.424433599999929], [-78.63385548799988, -6.424968724999871], [-78.6342109869999, -6.426019474999976], [-78.63466986299994, -6.426546849999966], [-78.63475973799996, -6.426898474999916], [-78.63488086299992, -6.428074224999875], [-78.63534573699991, -6.429080098999975], [-78.63592973699991, -6.429769474999887], [-78.63636911299994, -6.43050384999998], [-78.63654486299993, -6.431480474999887], [-78.63680473799997, -6.431816349999963], [-78.63729098799996, -6.432144599999958], [-78.63786136299996, -6.432091849999949], [-78.63842973699991, -6.432175723999933], [-78.63926761299996, -6.43281234899996], [-78.63963673799998, -6.432996098999979], [-78.64020698699989, -6.432964848999973], [-78.64091411299995, -6.432331848999979], [-78.64135936299994, -6.431665973999941], [-78.64198636299994, -6.431251973999906], [-78.64336911299995, -6.430798848999871], [-78.64436523699993, -6.430331973999898], [-78.64601948799998, -6.430160099999966], [-78.64657223799998, -6.429962849999981], [-78.64683586299992, -6.429593724999904], [-78.64703911299995, -6.428753849999964], [-78.64772261299993, -6.427464849999978], [-78.64909373799998, -6.425980473999914], [-78.64944923799999, -6.425429724999901], [-78.64966011299998, -6.424744098999952], [-78.64971673799988, -6.424265599999956], [-78.65064386299997, -6.422491474999902], [-78.6513346129999, -6.422284349999927], [-78.65207161299998, -6.422063349999917], [-78.65312973699992, -6.422356724999929], [-78.65463286299996, -6.422455099999979], [-78.65566211199996, -6.421999974999892], [-78.65704248799995, -6.42066822399994], [-78.65808548799998, -6.418987099999924], [-78.65839186299996, -6.417638099999976], [-78.65858048799998, -6.416806723999912], [-78.65982811299995, -6.412046974999896], [-78.66020061299992, -6.410994724999966], [-78.660294863, -6.410728474999871], [-78.66051773799995, -6.409716848999949], [-78.66054448799997, -6.409287348999953], [-78.66057423799992, -6.408814474999872], [-78.66052536299998, -6.407828099999904], [-78.66055861299998, -6.406345723999891], [-78.66048436299997, -6.405080098999974], [-78.66062298799989, -6.404476224999939], [-78.66078711299997, -6.403761724999981], [-78.66083373799984, -6.403425599999878], [-78.66103123799991, -6.401999849999925], [-78.66139648799992, -6.401134724999963], [-78.6615604879999, -6.400601599999902], [-78.6615097369999, -6.400158223999881], [-78.66114061299999, -6.399787099999912], [-78.66145698799988, -6.399769473999868], [-78.66208786299995, -6.399962848999962], [-78.6632617379999, -6.399994098999969], [-78.66356048799992, -6.400140599999929], [-78.66409973799995, -6.400603474999969], [-78.66440623799991, -6.400677723999877], [-78.6646152379999, -6.400607474999958], [-78.66534961299999, -6.399904349999929], [-78.66561323699995, -6.399824224999975], [-78.66609173799992, -6.399845724999977], [-78.66604823799997, -6.397553599999924], [-78.66665786299995, -6.396574348999934], [-78.66817948799991, -6.395036099999913], [-78.6692463629999, -6.393957849999879], [-78.67267948799991, -6.392440098999884], [-78.67349923799998, -6.391722223999921], [-78.67487561299993, -6.390516974999912], [-78.6757332379999, -6.389765848999957], [-78.67640698799988, -6.389065974999937], [-78.67759436199998, -6.387832473999936], [-78.67907598799991, -6.38514022499993], [-78.6792326129999, -6.385013349999952], [-78.67945536299987, -6.384832974999938], [-78.68008786299998, -6.38479684899994], [-78.68070223799992, -6.385085973999878], [-78.68125986299998, -6.385109599999907], [-78.68198511299994, -6.38514022499993], [-78.68294273799995, -6.384688474999962], [-78.68335836199998, -6.384652348999907], [-78.68376373799993, -6.384753849999981], [-78.68400023799995, -6.384966598999881], [-78.68499248799998, -6.385859473999972], [-78.68523436299984, -6.38607709899992], [-78.68577961299991, -6.386567598999932], [-78.68662873799991, -6.386838724999961], [-78.68722511299995, -6.386730223999962], [-78.68823873799988, -6.385759724999957], [-78.68859886299992, -6.385168224999973], [-78.68881223799991, -6.384817723999902], [-78.68944648699983, -6.385126974999935], [-78.69019548799997, -6.386044599999821], [-78.69148036299998, -6.38761859899995], [-78.69292586299991, -6.388999974999933], [-78.6936919879999, -6.389148098999897], [-78.69416511299988, -6.388890848999949], [-78.69474023699996, -6.388358724999875], [-78.695383613, -6.387476973999924], [-78.69643436299998, -6.387228098999969], [-78.69784061299998, -6.38726534999995], [-78.70026773799998, -6.388184099999933], [-78.70276111299995, -6.390087849999873], [-78.70280111299996, -6.390117099999884], [-78.70378911299991, -6.390221099999962], [-78.70477398799989, -6.389913349999972], [-78.70628511299986, -6.389441099999829], [-78.70724361299995, -6.389498599999968], [-78.70790798799993, -6.389680224999893], [-78.70882773699992, -6.39012809899998], [-78.70896811299997, -6.39019634999994], [-78.71047261299992, -6.390582724999945], [-78.7110024879999, -6.390554849999944], [-78.71190973799992, -6.389717349999955], [-78.71245236299995, -6.389216474999955], [-78.71387461299997, -6.385981848999961], [-78.71417186299993, -6.384886724999944], [-78.71395823699987, -6.383388598999886], [-78.71374186299988, -6.381858224999917], [-78.71415336299992, -6.379261723999946], [-78.71376286299994, -6.377226223999912], [-78.71302923699994, -6.374780099999953], [-78.71267548799995, -6.373601224999902], [-78.71278711199994, -6.371230974999889], [-78.71356786299998, -6.369836974999942], [-78.71408786199993, -6.368482474999951], [-78.71289398699992, -6.36748984999997], [-78.70761836199995, -6.365515724999966], [-78.70604186299988, -6.364177224999878], [-78.70331436299989, -6.362978599999849], [-78.69880823799991, -6.362188723999964], [-78.69722848799995, -6.361101474999941], [-78.69564098799998, -6.359613598999942], [-78.69442411299991, -6.358314099999973], [-78.69397136299995, -6.357830473999968], [-78.69246073799991, -6.356391223999879], [-78.69160736299989, -6.355578099999946], [-78.69153711299998, -6.35319334999997], [-78.69164848699995, -6.352326224999956], [-78.69164448799995, -6.351150349999955], [-78.6914238629999, -6.349937473999944], [-78.69119336199992, -6.349105473999941], [-78.6911426129999, -6.348138723999966], [-78.69090436199991, -6.34716009899995], [-78.69060948799995, -6.346310599999981], [-78.68974611199991, -6.345265599999948], [-78.68961136299998, -6.345021474999896], [-78.68949798799991, -6.344199223999965], [-78.68924998699998, -6.343357474999891], [-78.68905273799993, -6.342939474999923], [-78.68780273799996, -6.34158784899995], [-78.68645111199999, -6.340560599999947], [-78.68544136199989, -6.340113224999868], [-78.6846933619999, -6.339648473999944], [-78.68344136299999, -6.339009724999869], [-78.68253898799992, -6.338654349999956], [-78.68095111299982, -6.338185599999974], [-78.67972461299996, -6.337746098999958], [-78.67898636299998, -6.337290974999917], [-78.67788861299994, -6.336355473999902], [-78.67681448799993, -6.33580859999995], [-78.67629298799994, -6.335335974999907], [-78.67604098699996, -6.335027349999962], [-78.67507036299997, -6.334273474999918], [-78.6740682379999, -6.333734349999929], [-78.67328323699996, -6.333605474999899], [-78.67284173699994, -6.333449224999868], [-78.67233786299994, -6.333021474999896], [-78.67177148799993, -6.332675724999888], [-78.67179486199996, -6.333363223999925], [-78.67203323799993, -6.334294973999931], [-78.67217186299996, -6.335687474999872], [-78.67236723799994, -6.336419973999909], [-78.67253511199988, -6.337478473999909], [-78.6724687379999, -6.337859349999974], [-78.67220511299996, -6.338400348999869], [-78.67100586299995, -6.33990434899988], [-78.67063286299998, -6.340517598999952], [-78.67034173799993, -6.341130848999967], [-78.6696367379999, -6.343152474999954], [-78.6695917379999, -6.345093724999913], [-78.66931836299995, -6.347353473999931], [-78.66892773799992, -6.34810159999995], [-78.66844536299999, -6.348767599999974], [-78.66819923799994, -6.349337849999927], [-78.6671562379999, -6.350181474999886], [-78.66677348699994, -6.350822349999873], [-78.66648236199995, -6.351560599999971], [-78.66609373799992, -6.353384723999966], [-78.6657284879999, -6.354468723999958], [-78.66484373799989, -6.356064473999936], [-78.66455073799989, -6.357066349999968], [-78.6640839879999, -6.358330099999876], [-78.66355661299997, -6.359095723999928], [-78.66324611299996, -6.359699224999929], [-78.66309961199988, -6.360242224999922], [-78.66305273799992, -6.362691349999977], [-78.66290623799989, -6.363197223999975], [-78.66230873799992, -6.364816348999909], [-78.66218548799992, -6.365275348999887], [-78.66131098799997, -6.366464098999927], [-78.66063398799992, -6.366838724999923], [-78.65794411299993, -6.367258724999942], [-78.65585261299998, -6.368178974999978], [-78.65376761299996, -6.369674224999869], [-78.65305148699997, -6.369834348999973]]]], "type": "MultiPolygon"}, "properties": {"AREA": 1, "CAPITAL": "TACABAMBA", "CODCCPP": "0001", "DEPARTAMEN": "CAJAMARCA", "DISTRITO": "TACABAMBA", "FUENTE": "INEI", "IDDIST": "060417", "IDDPTO": "06", "IDPROV": "0604", "PROVINCIA": "CHOTA"}, "type": "Feature"}], "type": "FeatureCollection"});

        
    
            geo_json_1091ac6d23d1030630f6c8bab5b6f53f.addTo(feature_group_5e24ce67df1756499e19bdcbd436fd98);
        
    
            feature_group_5e24ce67df1756499e19bdcbd436fd98.addTo(map_108c0da2461da55f1d316e477c36d0aa);
        
    
            var feature_group_10e0b835e1b74b8e68465dc2a140b169 = L.featureGroup(
                {
}
            );
        
    
            var circle_bbe40b55c1684a20a926c483d6454a71 = L.circle(
                [-6.3961815, -78.6129181],
                {"bubblingMouseEvents": true, "className": "zs-buffer", "color": "#1d4ed8", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#1d4ed8", "fillOpacity": 0.5, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 50, "stroke": true, "weight": 2}
            ).addTo(feature_group_10e0b835e1b74b8e68465dc2a140b169);
        
    
            var circle_3a9d8afbc421663eb77c492298f98a16 = L.circle(
                [-6.4221451, -78.6325666],
                {"bubblingMouseEvents": true, "className": "zs-buffer", "color": "#1d4ed8", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#1d4ed8", "fillOpacity": 0.5, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 50, "stroke": true, "weight": 2}
            ).addTo(feature_group_10e0b835e1b74b8e68465dc2a140b169);
        
    
            var circle_6b571d88d05b3f08999aef2f58d41870 = L.circle(
                [-6.4221352, -78.6325424],
                {"bubblingMouseEvents": true, "className": "zs-buffer", "color": "#1d4ed8", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#1d4ed8", "fillOpacity": 0.5, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 50, "stroke": true, "weight": 2}
            ).addTo(feature_group_10e0b835e1b74b8e68465dc2a140b169);
        
    
            feature_group_10e0b835e1b74b8e68465dc2a140b169.addTo(map_108c0da2461da55f1d316e477c36d0aa);
        
    
            var feature_group_c1acc3c50c3b50d863489b51a8db8567 = L.featureGroup(
                {
}
            );
        
    
            var circle_marker_422efbe3f255217848bd01c0e37a2922 = L.circleMarker(
                [-6.3961815, -78.6129181],
                {"bubblingMouseEvents": true, "color": "#1d4ed8", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#1d4ed8", "fillOpacity": 1.0, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 5, "stroke": true, "weight": 2}
            ).addTo(feature_group_c1acc3c50c3b50d863489b51a8db8567);
        
    
        var popup_886569a778308d4c84e8cfcc87088549 = L.popup({
  "maxWidth": 460,
});

        
            
                var html_27846f9faa9b604f91a2121910950462 = $(`<div id="html_27846f9faa9b604f91a2121910950462" style="width: 100.0%; height: 100.0%;"><div style='font-size:12px;'><div style='font-weight:700; margin-bottom:6px;'>Intersecci√≥n priorizada</div><table style='border-collapse:collapse;'><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>id_int</th><td style='padding:2px 0;'>l-235757</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>latitud</th><td style='padding:2px 0;'>-6.3961815</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>longitud</th><td style='padding:2px 0;'>-78.6129181</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>vias</th><td style='padding:2px 0;'>Avenida Aviaci√≥n</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>siniestro_fatal</th><td style='padding:2px 0;'>1</td></tr></table></div></div>`)[0];
                popup_886569a778308d4c84e8cfcc87088549.setContent(html_27846f9faa9b604f91a2121910950462);
            
        

        circle_marker_422efbe3f255217848bd01c0e37a2922.bindPopup(popup_886569a778308d4c84e8cfcc87088549)
        ;

        
    
    
            circle_marker_422efbe3f255217848bd01c0e37a2922.bindTooltip(
                `<div>
                      | 
                 </div>`,
                {
  "opacity": 0,
  "sticky": false,
}
            );
        
    
            var circle_marker_6ba214e7287d2bf3443822f6c550c886 = L.circleMarker(
                [-6.4221451, -78.6325666],
                {"bubblingMouseEvents": true, "color": "#1d4ed8", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#1d4ed8", "fillOpacity": 1.0, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 5, "stroke": true, "weight": 2}
            ).addTo(feature_group_c1acc3c50c3b50d863489b51a8db8567);
        
    
        var popup_7050de39ecfbdecdd7df509674ee0984 = L.popup({
  "maxWidth": 460,
});

        
            
                var html_74967a10788b212066fdcaac16de1651 = $(`<div id="html_74967a10788b212066fdcaac16de1651" style="width: 100.0%; height: 100.0%;"><div style='font-size:12px;'><div style='font-weight:700; margin-bottom:6px;'>Intersecci√≥n priorizada</div><table style='border-collapse:collapse;'><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>id_int</th><td style='padding:2px 0;'>l-320946</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>latitud</th><td style='padding:2px 0;'>-6.4221451</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>longitud</th><td style='padding:2px 0;'>-78.6325666</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>vias</th><td style='padding:2px 0;'>-</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>siniestro_fatal</th><td style='padding:2px 0;'>1</td></tr></table></div></div>`)[0];
                popup_7050de39ecfbdecdd7df509674ee0984.setContent(html_74967a10788b212066fdcaac16de1651);
            
        

        circle_marker_6ba214e7287d2bf3443822f6c550c886.bindPopup(popup_7050de39ecfbdecdd7df509674ee0984)
        ;

        
    
    
            circle_marker_6ba214e7287d2bf3443822f6c550c886.bindTooltip(
                `<div>
                      | 
                 </div>`,
                {
  "opacity": 0,
  "sticky": false,
}
            );
        
    
            var circle_marker_c0659ab42880a2da43232783d9e93867 = L.circleMarker(
                [-6.4221352, -78.6325424],
                {"bubblingMouseEvents": true, "color": "#1d4ed8", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#1d4ed8", "fillOpacity": 1.0, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 5, "stroke": true, "weight": 2}
            ).addTo(feature_group_c1acc3c50c3b50d863489b51a8db8567);
        
    
        var popup_e497b132adf78adbd89bf1b63580e43a = L.popup({
  "maxWidth": 460,
});

        
            
                var html_1e38f345f34e9fa5b31a8768ef5a9401 = $(`<div id="html_1e38f345f34e9fa5b31a8768ef5a9401" style="width: 100.0%; height: 100.0%;"><div style='font-size:12px;'><div style='font-weight:700; margin-bottom:6px;'>Intersecci√≥n priorizada</div><table style='border-collapse:collapse;'><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>id_int</th><td style='padding:2px 0;'>l-802381</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>latitud</th><td style='padding:2px 0;'>-6.4221352</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>longitud</th><td style='padding:2px 0;'>-78.6325424</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>vias</th><td style='padding:2px 0;'>-</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>siniestro_fatal</th><td style='padding:2px 0;'>1</td></tr></table></div></div>`)[0];
                popup_e497b132adf78adbd89bf1b63580e43a.setContent(html_1e38f345f34e9fa5b31a8768ef5a9401);
            
        

        circle_marker_c0659ab42880a2da43232783d9e93867.bindPopup(popup_e497b132adf78adbd89bf1b63580e43a)
        ;

        
    
    
            circle_marker_c0659ab42880a2da43232783d9e93867.bindTooltip(
                `<div>
                      | 
                 </div>`,
                {
  "opacity": 0,
  "sticky": false,
}
            );
        
    
            feature_group_c1acc3c50c3b50d863489b51a8db8567.addTo(map_108c0da2461da55f1d316e477c36d0aa);
        
    
            var feature_group_608dd1eca2eebea3baa3ee318eafc1b7 = L.featureGroup(
                {
}
            );
        
    
            var circle_marker_6b2b040f2cfad6ed9a29039e909f38f7 = L.circleMarker(
                [-6.4048889, -78.580102],
                {"bubblingMouseEvents": true, "color": "#d90429", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#d90429", "fillOpacity": 1.0, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 5, "stroke": true, "weight": 2}
            ).addTo(feature_group_608dd1eca2eebea3baa3ee318eafc1b7);
        
    
        var popup_519117d5d2cc0d9e56c401d44b1b2845 = L.popup({
  "maxWidth": 480,
});

        
            
                var html_cb5b9f954b0f2c52cc1bc8ee80b61c60 = $(`<div id="html_cb5b9f954b0f2c52cc1bc8ee80b61c60" style="width: 100.0%; height: 100.0%;"><div style='font-size:12px;'><div style='font-weight:700; margin-bottom:6px;'>Siniestro fatal</div><table style='border-collapse:collapse;'><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>COD_ACCIDE</th><td style='padding:2px 0;'>A-2021-08-144</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>FechaDelAccidente</th><td style='padding:2px 0;'>26/08/2021</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>HoraDelAccidente</th><td style='padding:2px 0;'>18:30</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>ClaseDelAccidente</th><td style='padding:2px 0;'>DESPISTE</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>SecuenciaAccidente</th><td style='padding:2px 0;'>--------------</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CantidadDeFallecidos</th><td style='padding:2px 0;'>1</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CantidadDeLesionados</th><td style='padding:2px 0;'>0</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>Direccion</th><td style='padding:2px 0;'>TROCHA CARROZABLE TACABAMBA - CAS. CHUCMAR</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>LugarReferencia</th><td style='padding:2px 0;'>---------------</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>y</th><td style='padding:2px 0;'>-6.4048889</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>x</th><td style='padding:2px 0;'>-78.580102</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CondClimatica</th><td style='padding:2px 0;'>DESPEJADO</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CausaFactorPrincipal</th><td style='padding:2px 0;'>NO IDENTIFICA LA CAUSA</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CausaEspecifica</th><td style='padding:2px 0;'></td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>OtraCausa</th><td style='padding:2px 0;'></td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>Observaciones</th><td style='padding:2px 0;'></td></tr></table></div></div>`)[0];
                popup_519117d5d2cc0d9e56c401d44b1b2845.setContent(html_cb5b9f954b0f2c52cc1bc8ee80b61c60);
            
        

        circle_marker_6b2b040f2cfad6ed9a29039e909f38f7.bindPopup(popup_519117d5d2cc0d9e56c401d44b1b2845)
        ;

        
    
    
            var circle_marker_4f137251efe44ba81925ac073ea9d9a7 = L.circleMarker(
                [-6.396261, -78.612985],
                {"bubblingMouseEvents": true, "color": "#d90429", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#d90429", "fillOpacity": 1.0, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 5, "stroke": true, "weight": 2}
            ).addTo(feature_group_608dd1eca2eebea3baa3ee318eafc1b7);
        
    
        var popup_c82fc32db54002ce1553ec7b896eb577 = L.popup({
  "maxWidth": 480,
});

        
            
                var html_a32ee30528538f7a4de87fd76d2facff = $(`<div id="html_a32ee30528538f7a4de87fd76d2facff" style="width: 100.0%; height: 100.0%;"><div style='font-size:12px;'><div style='font-weight:700; margin-bottom:6px;'>Siniestro fatal</div><table style='border-collapse:collapse;'><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>COD_ACCIDE</th><td style='padding:2px 0;'>A-2023-10-155</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>FechaDelAccidente</th><td style='padding:2px 0;'>13/10/2023</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>HoraDelAccidente</th><td style='padding:2px 0;'>05:30</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>ClaseDelAccidente</th><td style='padding:2px 0;'>CHOQUE FUGA</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>SecuenciaAccidente</th><td style='padding:2px 0;'></td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CantidadDeFallecidos</th><td style='padding:2px 0;'>1</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CantidadDeLesionados</th><td style='padding:2px 0;'>1</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>Direccion</th><td style='padding:2px 0;'>AV. AVIACION CDRA. 02</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>LugarReferencia</th><td style='padding:2px 0;'></td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>y</th><td style='padding:2px 0;'>-6.396261</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>x</th><td style='padding:2px 0;'>-78.612985</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CondClimatica</th><td style='padding:2px 0;'>DESPEJADO</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CausaFactorPrincipal</th><td style='padding:2px 0;'>IMPRUDENCIA DEL CONDUCTOR</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CausaEspecifica</th><td style='padding:2px 0;'>CONDUCIR EN ESTADO DE EBRIEDAD Y/O DROGADICCI√ìN</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>OtraCausa</th><td style='padding:2px 0;'></td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>Observaciones</th><td style='padding:2px 0;'></td></tr></table></div></div>`)[0];
                popup_c82fc32db54002ce1553ec7b896eb577.setContent(html_a32ee30528538f7a4de87fd76d2facff);
            
        

        circle_marker_4f137251efe44ba81925ac073ea9d9a7.bindPopup(popup_c82fc32db54002ce1553ec7b896eb577)
        ;

        
    
    
            var circle_marker_cc7a180a9d96afa9c3d20759574d50b6 = L.circleMarker(
                [-6.422162, -78.632533],
                {"bubblingMouseEvents": true, "color": "#d90429", "dashArray": null, "dashOffset": null, "fill": true, "fillColor": "#d90429", "fillOpacity": 1.0, "fillRule": "evenodd", "lineCap": "round", "lineJoin": "round", "opacity": 1.0, "radius": 5, "stroke": true, "weight": 2}
            ).addTo(feature_group_608dd1eca2eebea3baa3ee318eafc1b7);
        
    
        var popup_4a2870d685b84488c808b9cb7af7d37c = L.popup({
  "maxWidth": 480,
});

        
            
                var html_666096f2862add2aadc91065452a7398 = $(`<div id="html_666096f2862add2aadc91065452a7398" style="width: 100.0%; height: 100.0%;"><div style='font-size:12px;'><div style='font-weight:700; margin-bottom:6px;'>Siniestro fatal</div><table style='border-collapse:collapse;'><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>COD_ACCIDE</th><td style='padding:2px 0;'>A-2023-10-157</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>FechaDelAccidente</th><td style='padding:2px 0;'>17/10/2023</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>HoraDelAccidente</th><td style='padding:2px 0;'>05:30</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>ClaseDelAccidente</th><td style='padding:2px 0;'>DESPISTE</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>SecuenciaAccidente</th><td style='padding:2px 0;'>TOTAL CON CONSECUENCIA VOLCADURA EN TONEL ERECHO 1/2</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CantidadDeFallecidos</th><td style='padding:2px 0;'>1</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CantidadDeLesionados</th><td style='padding:2px 0;'>0</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>Direccion</th><td style='padding:2px 0;'>CARRETERA DE TACABAMBA AL DISTRITO CONCHAN ALTURA EL PUENTE LA LEGUS</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>LugarReferencia</th><td style='padding:2px 0;'></td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>y</th><td style='padding:2px 0;'>-6.422162</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>x</th><td style='padding:2px 0;'>-78.632533</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CondClimatica</th><td style='padding:2px 0;'>DESPEJADO</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CausaFactorPrincipal</th><td style='padding:2px 0;'>IMPRUDENCIA DEL CONDUCTOR</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>CausaEspecifica</th><td style='padding:2px 0;'>EXCESO DE VELOCIDAD</td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>OtraCausa</th><td style='padding:2px 0;'></td></tr><tr><th style='text-align:left; padding:2px 8px 2px 0; white-space:nowrap;'>Observaciones</th><td style='padding:2px 0;'></td></tr></table></div></div>`)[0];
                popup_4a2870d685b84488c808b9cb7af7d37c.setContent(html_666096f2862add2aadc91065452a7398);
            
        

        circle_marker_cc7a180a9d96afa9c3d20759574d50b6.bindPopup(popup_4a2870d685b84488c808b9cb7af7d37c)
        ;

        
    
    
            feature_group_608dd1eca2eebea3baa3ee318eafc1b7.addTo(map_108c0da2461da55f1d316e477c36d0aa);
        
    
            map_108c0da2461da55f1d316e477c36d0aa.fitBounds(
                [[-6.3961815, -78.6129181], [-6.4221451, -78.6325666], [-6.4221352, -78.6325424]],
                {}
            );
        
    
            var layer_control_0a672a54ca1efa7b33599564bc5e2f57_layers = {
                base_layers : {
                    "openstreetmap" : tile_layer_5e19b3b297d98a719d413439ffa16e24,
                },
                overlays :  {
                    "contorno" : feature_group_5e24ce67df1756499e19bdcbd436fd98,
                    "intersecciones: buffers (50m)" : feature_group_10e0b835e1b74b8e68465dc2a140b169,
                    "intersecciones: puntos" : feature_group_c1acc3c50c3b50d863489b51a8db8567,
                    "siniestros fatales" : feature_group_608dd1eca2eebea3baa3ee318eafc1b7,
                },
            };
            let layer_control_0a672a54ca1efa7b33599564bc5e2f57 = L.control.layers(
                layer_control_0a672a54ca1efa7b33599564bc5e2f57_layers.base_layers,
                layer_control_0a672a54ca1efa7b33599564bc5e2f57_layers.overlays,
                {
  "position": "topright",
  "collapsed": true,
  "autoZIndex": true,
}
            ).addTo(map_108c0da2461da55f1d316e477c36d0aa);

        
    
        feature_group_c1acc3c50c3b50d863489b51a8db8567.bringToFront();
        feature_group_608dd1eca2eebea3baa3ee318eafc1b7.bringToFront();
    
    
      (function() {
        var puntosLayer = feature_group_c1acc3c50c3b50d863489b51a8db8567;
        var defaultColor = '#1d4ed8';
        var hiliteColor  = '#f59e0b';

        // ---------- Toggle colapsar/expandir ----------
        var box = document.getElementById('zs_tools');
        var btnToggle = document.getElementById('btn_toggle_box');
        var saved = null;
        try { saved = localStorage.getItem('zs_tools_collapsed'); } catch(e) {}
        if (saved === '1') {
          box.classList.add('collapsed');
          btnToggle.textContent = '‚Øà Mostrar';
        }
        function toggleBox() {
          var collapsed = box.classList.toggle('collapsed');
          btnToggle.textContent = collapsed ? '‚Øà Mostrar' : '‚ØÜ Ocultar';
          try { localStorage.setItem('zs_tools_collapsed', collapsed ? '1' : '0'); } catch(e) {}
        }
        btnToggle.addEventListener('click', toggleBox);

        // ---------- Esperar a que el mapa est√© disponible ----------
        var ly_map = null;
        function ensureMap(cb) {
          var tries = 0;
          (function wait() {
            ly_map = (puntosLayer && puntosLayer._map) ? puntosLayer._map : null;
            if (ly_map) { cb(); return; }
            if (tries++ < 80) { setTimeout(wait, 50); }
          })();
        }

        ensureMap(function initTools() {
          // ---------- Utilidades ----------
          function eachMarker(fn) {
            if (!puntosLayer || !puntosLayer._layers) return;
            Object.values(puntosLayer._layers).forEach(function(ly) {
              if (ly && typeof ly.setStyle === 'function') fn(ly);
            });
          }

          function getTooltipText(ly) {
            try {
              var t = ly.getTooltip();
              return t ? String(t.getContent() || '').toLowerCase() : '';
            } catch(e) { return ''; }
          }

          function clearHighlights() {
            eachMarker(function(ly) {
              ly.setStyle({ color: defaultColor, fillColor: defaultColor });
            });
          }

          // ---------- B√∫squeda ----------
          function searchAndHighlight() {
            var qn_raw = (document.getElementById('q_name').value || '');
            var qc_raw = (document.getElementById('q_code').value || '');
            var qn = qn_raw.toLowerCase();
            var qc = qc_raw.toLowerCase();

            var useName = qn_raw.trim().length > 0;
            var useCode = qc_raw.trim().length > 0;

            clearHighlights();
            if (!useName && !useCode) return;

            var matchedLatLngs = [];
            eachMarker(function(ly) {
              var txt = getTooltipText(ly); // "nombre | codigo"
              var parts = txt.split('|', 2);
              var nameTxt = (parts[0] || '').trim();
              var codeTxt = (parts[1] || '').trim();

              var matchName = useName ? (nameTxt.indexOf(qn) !== -1) : false;
              var matchCode = useCode ? (codeTxt.indexOf(qc) !== -1) : false;

              if (matchName || matchCode) {
                ly.setStyle({ color: hiliteColor, fillColor: hiliteColor });
                if (ly.getLatLng) matchedLatLngs.push(ly.getLatLng());
              }
            });

            if (matchedLatLngs.length > 0) {
              var group = L.featureGroup(matchedLatLngs.map(function(ll) { return L.marker(ll); }));
              try { ly_map.fitBounds(group.getBounds().pad(0.2)); } catch(e) {}
            }
          }

          document.getElementById('btn_search').addEventListener('click', searchAndHighlight);
          document.getElementById('btn_clear').addEventListener('click', function() {
            document.getElementById('q_name').value = '';
            document.getElementById('q_code').value = '';
            clearHighlights();
          });
          ['q_name','q_code'].forEach(function(id) {
            var el = document.getElementById(id);
            el.addEventListener('keydown', function(ev) { if (ev.key === 'Enter') searchAndHighlight(); });
          });

          // ---------- Pin por coordenadas ----------
          var coordLayer = L.layerGroup().addTo(ly_map);
          function goToXY() {
            var x = parseFloat((document.getElementById('q_x').value || '').replace(',', '.'));
            var y = parseFloat((document.getElementById('q_y').value || '').replace(',', '.'));
            if (!isFinite(x) || !isFinite(y)) return;
            coordLayer.clearLayers();
            var mk = L.marker([y, x], { draggable:false, title: 'Punto (Y,X): '+y+', '+x });
            mk.addTo(coordLayer);
            ly_map.setView([y, x], Math.max(ly_map.getZoom(), 17));
          }
          function clearXY() { coordLayer.clearLayers(); }
          document.getElementById('btn_xy_go').addEventListener('click', goToXY);
          document.getElementById('btn_xy_clear').addEventListener('click', clearXY);

          // ---------- Medici√≥n ----------
          var measuring = false;
          var mA = null, mB = null, mLine = null;

          function haversine(lat1, lon1, lat2, lon2) {
            var R = 6371000;
            var dLat = (lat2-lat1) * Math.PI/180;
            var dLon = (lon2-lon1) * Math.PI/180;
            var a = Math.sin(dLat/2)*Math.sin(dLat/2) +
                    Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180) *
                    Math.sin(dLon/2)*Math.sin(dLon/2);
            var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
          }

          function updateMeasure() {
            if (!(mA && mB)) return;
            var a = mA.getLatLng(), b = mB.getLatLng();
            var d = haversine(a.lat, a.lng, b.lat, b.lng);
            var txt = (d >= 1000) ? (d/1000).toFixed(3)+' km' : Math.round(d)+' m';

            if (!mLine) {
              mLine = L.polyline([a, b], { color: '#111827', weight: 3, dashArray: '6,4' })
                .bindTooltip(txt, { permanent:true, direction:'center', className:'dist-on-line' })
                .addTo(ly_map);
            } else {
              mLine.setLatLngs([a, b]);
              mLine.setTooltipContent(txt);
            }
          }

          function clearMeasure() {
            if (mA) ly_map.removeLayer(mA); mA = null;
            if (mB) ly_map.removeLayer(mB); mB = null;
            if (mLine) ly_map.removeLayer(mLine); mLine = null;
          }

          function toggleMeasure() {
            measuring = !measuring;
            var stateSpan = document.getElementById('measure_state');
            stateSpan.textContent = measuring ? 'Activo' : 'Desactivado';
            stateSpan.style.color = measuring ? '#065f46' : '#991b1b';
            if (!measuring) {
              clearMeasure();
              ly_map.getContainer().style.cursor = '';
              return;
            }
            ly_map.getContainer().style.cursor = 'crosshair';
          }

          document.getElementById('btn_measure_toggle').addEventListener('click', toggleMeasure);

          ly_map.on('click', function(ev) {
            if (!measuring) return;
            if (!mA) {
              mA = L.marker(ev.latlng, { draggable:true, title:'Punto A' }).addTo(ly_map);
              mA.on('drag', updateMeasure);
            } else if (!mB) {
              mB = L.marker(ev.latlng, { draggable:true, title:'Punto B' }).addTo(ly_map);
              mB.on('drag', updateMeasure);
            } else {
              mB.setLatLng(ev.latlng);
            }
            updateMeasure();
          });

          // ---------- Abrir vista actual en Google Maps ----------
          function openInGoogleMaps() {
            var c = ly_map.getCenter();
            var z = ly_map.getZoom();
            var url = 'https://www.google.com/maps/@' + c.lat + ',' + c.lng + ',' + z + 'z';
            window.open(url, '_blank');
          }
          document.getElementById('btn_open_gmaps').addEventListener('click', openInGoogleMaps);
        });
      })();
    
</script>
</html>